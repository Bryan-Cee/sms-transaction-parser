// const messages = [
//   'QLS36WR65R Confirmed.Ksh3,500.00 transferred from M-Shwari account on 28/12/22 at 1:21 PM. M-Shwari balance is Ksh0.50 .M-PESA balance is Ksh4,314.26 .Transaction cost Ksh.0.00',
//   'QLR551N4W5 Confirmed. Ksh99.00 sent to KCB Paybill AC for account 1215681224 on 27/12/22 at 3:55 PM New M-PESA balance is Ksh480.26. Transaction cost, Ksh0.00.Amount you can transact within the day is 295,003.00. Download M-PESA app on https://mpesaapp.page.link/ggGV & get 500MB.',
//   'QLR75GRTQT Confirmed. You have received Ksh7,500.00 from NCBA BANK on 27/12/22 at 6:47 PM. New M-PESA balance is Ksh7,664.26. Separate personal and business funds through Pochi la Biashara on *334#.',
//   'QLR55HADP5 Confirmed.Ksh7,000.00 transferred to M-Shwari account on 27/12/22 at 6:52 PM. M-PESA balance is Ksh664.26 .New M-Shwari saving account balance is Ksh7,000.50. Transaction cost Ksh.0.00',
//   'QLR45W5W0K Confirmed. Ksh2,528.00 sent to KIPRONO  VINCENT 0725390765 on 27/12/22 at 9:25 PM. New M-PESA balance is Ksh585.26. Transaction cost, Ksh51.00. Amount you can transact within the day is 285,165.00. Get a loan today from M-Shwari click https://mpesaapp.page.link/mshwari',
//   'QLR551N4W5 Confirmed. Ksh99.00 sent to KCB Paybill AC for account 1215681224 on 27/12/22 at 3:55 PM New M-PESA balance is Ksh480.26. Transaction cost, Ksh0.00.Amount you can transact within the day is 295,003.00. Download M-PESA app on https://mpesaapp.page.link/ggGV & get 500MB.',
//   'QLR34CVVK5 Confirmed. Ksh1,200.00 sent to ROBERT  NGENO 0721550299 on 27/12/22 at 10:39 AM. New M-PESA balance is Ksh229.26. Transaction cost, Ksh22.00. Amount you can transact within the day is 295,252.00. Get a loan today from M-Shwari click https://mpesaapp.page.link/mshwari',
//   'QLR94D4CO7 Confirmed. Ksh150.00 paid to KERICHO APEX SERVICE STATION VIA COOP BANK. on 27/12/22 at 10:42 AM.New M-PESA balance is Ksh79.26. Transaction cost, Ksh0.00. Amount you can transact within the day is 295,102.00. Pay with M-PESA GlobalPay virtual Visa card linked to MPESA wallet. Click https://bit.ly/3LQTXIT',
//   'QLR24C1TZ6 Confirmed. Ksh200.00 sent to ERNEST  BETT 0724473805 on 27/12/22 at 10:28 AM. New M-PESA balance is Ksh2,463.26. Transaction cost, Ksh6.00. Amount you can transact within the day is 297,452.00. Get a loan today from M-Shwari click https://mpesaapp.page.link/mshwari',
//   'QLR449G8HU Confirmed. Ksh90.00 sent to Caroline  Rutto 0719896447 on 27/12/22 at 9:54 AM. New M-PESA balance is Ksh4,771.26. Transaction cost, Ksh0.00. Amount you can transact within the day is 299,710.00. Get a loan today from M-Shwari click https://mpesaapp.page.link/mshwari',
//   'QLR047T3A2 Confirmed. Ksh200.00 sent to Stanley  Siele 0720715868 on 27/12/22 at 9:31 AM. New M-PESA balance is Ksh4,861.26. Transaction cost, Ksh6.00. Amount you can transact within the day is 299,800.00. Get a loan today from M-Shwari click https://mpesaapp.page.link/mshwari',
//   'QLQ236C2S6 Confirmed. Ksh200.00 paid to CHEBEWOR FILLING STATION LIMITED - CHEPNYOGAA. on 26/12/22 at 5:56 PM.New M-PESA balance is Ksh2,025.26. Transaction cost, Ksh0.00. Amount you can transact within the day is 279,325.00. Pay with M-PESA GlobalPay virtual Visa card linked to MPESA wallet. Click https://bit.ly/3LQTXIT',
//   'QLQ52P34V5 Confirmed.You have received Ksh3,000.00 from STANBIC to MPESA Retail 300248 on 26/12/22 at 2:27 PM New M-PESA balance is Ksh4,960.26.  Separate personal and business funds through Pochi la Biashara on *334#.',
//   'QLQ42ODWK8 Confirmed. Ksh15,900.00 sent to Equity Paybill Account for account 0702139730 on 26/12/22 at 2:18 PM New M-PESA balance is Ksh1,960.26. Transaction cost, Ksh0.00.Amount you can transact within the day is 282,260.00. Download M-PESA app on https://mpesaapp.page.link/ggGV & get 500MB.',
//   'QLQ21WG6UM Confirmed.on 26/12/22 at 8:08 AMWithdraw Ksh1,000.00 from 2130791 - IDEAS MERGE LTD Smith shop mbeere New M-PESA balance is Ksh316.26. Transaction cost, Ksh28.00. Amount you can transact within the day is 298,800.00. Pay for goods & Services Today using Lipa Na M-PESA!'
// ];
//
// const messagesTest = [
//   'QLS36WR65R Confirmed.Ksh3,500.00 transferred from M-Shwari account on 28/12/22 at 1:21 PM. M-Shwari balance is Ksh0.50 .M-PESA balance is Ksh4,314.26 .Transaction cost Ksh.0.00',
//   'QLR551N4W5 Confirmed. Ksh99.00 sent to KCB Paybill AC for account 1215681224 on 27/12/22 at 3:55 PM New M-PESA balance is Ksh480.26. Transaction cost, Ksh0.00.Amount you can transact within the day is 295,003.00. Download M-PESA app on https://mpesaapp.page.link/ggGV & get 500MB.',
//   'QLQ21WG6UM Confirmed.on 26/12/22 at 8:08 AMWithdraw Ksh1,000.00 from 2130791 - IDEAS MERGE LTD Smith shop mbeere New M-PESA balance is Ksh316.26. Transaction cost, Ksh28.00. Amount you can transact within the day is 298,800.00. Pay for goods & Services Today using Lipa Na M-PESA!'
// ]

import { parseMessage } from '../src';

describe('parseMessage', () => {
  it('test for a valid m-shwari transfer', () => {
    const message = 'QLS36WR65R Confirmed.Ksh3,500.00 transferred from M-Shwari account on 28/12/22 at 1:21 PM. M-Shwari balance is Ksh0.50 .M-PESA balance is Ksh4,314.26 .Transaction cost Ksh.0.00';
    expect(parseMessage(message)).toEqual({
      reference: 'QLS36WR65R',
      amount: '3,500.00',
      transactionType: 'transferred',
      account: 'M-Shwari account',
      date: '28/12/22',
      time: '1:21 PM',
      mShwariBalance: '0.50',
      balance: '4,314.26',
      transactionCost: '0.00',
      type: 'M-SHWARI-WITHDRAW'
    });
  });

  it('test for an m-pesa sent to recipient', () => {
    const message = 'QLR45W5W0K Confirmed. Ksh2,528.00 sent to KIPRONO  VINCENT 0725390765 on 27/12/22 at 9:25 PM. New M-PESA balance is Ksh585.26. Transaction cost, Ksh51.00. Amount you can transact within the day is 285,165.00. Get a loan today from M-Shwari click https://mpesaapp.page.link/mshwari';
    expect(parseMessage(message)).toEqual({
      reference: 'QLR45W5W0K',
      amount: '2,528.00',
      transactionType: 'sent',
      recipient: 'KIPRONO  VINCENT 0725390765',
      date: '27/12/22',
      time: '9:25 PM',
      balance: '585.26',
      transactionCost: '51.00',
      type: 'M-PESA-SENT'
    });
  });

  it('test for an m-pesa withdrawal from agent', () => {
    const message = 'QLQ21WG6UM Confirmed.on 26/12/22 at 8:08 AMWithdraw Ksh1,000.00 from 2130791 - IDEAS MERGE LTD Smith shop mbeere New M-PESA balance is Ksh316.26. Transaction cost, Ksh28.00. Amount you can transact within the day is 298,800.00. Pay for goods & Services Today using Lipa Na M-PESA!';
    expect(parseMessage(message)).toEqual({
      reference: 'QLQ21WG6UM',
      date: '26/12/22',
      time: '8:08 AM',
      withdraw: '1,000.00',
      agent: '2130791 - IDEAS MERGE LTD Smith shop mbeere',
      balance: '316.26',
      transactionCost: '8.00',
      type: 'M-PESA-WITHDRAW'
    });
  });
});
